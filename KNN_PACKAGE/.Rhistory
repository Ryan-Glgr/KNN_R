install.packages("readxl")
install.packages("ggplot2")
install.packages("readxl")
install.packages("ggplot2")
# Read the Excel file
file_name <- "data.xlsx"
df <- read_excel(file_name)
install.packages("readxl")
library(readxl)
# Read the Excel file
file_name <- "data.xlsx"
df <- read_excel(file_name)
# Read the Excel file
file_name <- "./data.xlsx"
df <- read_excel(file_name)
# Ensure column names are correctly set
col_names <- colnames(df)
# Ensure column names are valid characters
col_names <- make.names(col_names, unique = TRUE)
# Assign corrected names back to the dataframe
colnames(df) <- col_names
# Get number of columns
num_cols <- length(col_names)
# Create an empty data frame to store correlation results
results <- data.frame(Column1 = character(),
Column2 = character(),
Pearson_R = numeric(),
R_squared = numeric(),
Spearman_Rho = numeric(),
stringsAsFactors = FALSE)
# Loop through each pair of columns
for (i in 1:(num_cols - 1)) {
for (j in (i + 1):num_cols) {
col1 <- col_names[i]
col2 <- col_names[j]
# Remove NA values
valid_data <- na.omit(df[, c(col1, col2)])
# Compute Pearson correlation
pearson_r <- cor(valid_data[[col1]], valid_data[[col2]], method = "pearson")
r_squared <- pearson_r^2
# Compute Spearman correlation
spearman_rho <- cor(valid_data[[col1]], valid_data[[col2]], method = "spearman")
# Store results
results <- rbind(results, data.frame(Column1 = col1,
Column2 = col2,
Pearson_R = pearson_r,
R_squared = r_squared,
Spearman_Rho = spearman_rho))
# Plot scatter plot with regression line
plot <- ggplot(valid_data, aes_string(x = col1, y = col2)) +
geom_point() +
geom_smooth(method = "lm", col = "blue", se = FALSE) +
labs(title = paste("Scatter Plot of", col1, "vs", col2),
x = col1, y = col2) +
theme_minimal()
# Save the plot with corrected file naming
plot_filename <- paste0("scatter_", gsub("[^A-Za-z0-9]", "_", col1), "_", gsub("[^A-Za-z0-9]", "_", col2), ".png")
ggsave(filename = plot_filename, plot = plot)
}
}
# Display correlation results
print(results)
# Save results to a CSV file
write.csv(results, "correlation_results.csv", row.names = FALSE)
getwd
getwd()
setwd(" C:\Users\snyde\OneDrive\Desktop\KNN_R\KNN_PACKAGE")
setwd(" C:\Users\snyde\OneDrive\Desktop\KNN_R\KNN_PACKAGE\")
setwd("C:\Users\snyde\OneDrive\Desktop\KNN_R\KNN_PACKAGE\")
setwd("C:\Users\snyde\OneDrive\Desktop\KNN_R\KNN_PACKAGE\")\
setwd("C:\Users\snyne\Onedrive\Desktop\KNN_R")
setwd("C:/Users/snyde/OneDrive/Desktop/KNN_R")
ls
R CMD INSTALL .
CMD INSTALL .
INSTALL .
chmod +x configure
setwd("C:/Users/snyde/OneDrive/Desktop/KNN_R/KNN_PACKAGE")
R CMD INSTALL .
CMD INSTALL .
configure
./configure
exec configure
run configure
